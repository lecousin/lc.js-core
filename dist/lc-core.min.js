String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),Array.prototype.contains=function(e){return-1!=this.indexOf(e)},Array.prototype.remove=function(e){for(var t=0;t<this.length;++t)this[t]==e&&(this.splice(t,1),t--)},Array.prototype.removeUnique=function(e){var t=this.indexOf(e);0<=t&&this.splice(t,1)},Array.prototype.isSame=function(e){if(!Array.isArray(e))return!1;if(this.length!=e.length)return!1;for(var t=0;t<this.length;++t)if(this[t]!==e[t])return!1;return!0},Array.prototype.clear=function(){0<this.length&&this.splice(0,this.length)},Array.prototype.removeElements=function(e){for(var t=0;t<this.length;++t)e.contains(this[t])&&(this.splice(t,1),t--)},Array.prototype.pushAll=function(e){Array.prototype.push.apply(this,e)},"undefined"==typeof lc&&(lc={}),lc.core={namespace:function(e,t){for(var n=e.split("."),s=window,r=0;r<n.length;++r)void 0===s[n[r]]&&(s[n[r]]={}),s=s[n[r]];return lc.core.merge(s,t)},merge:function(e,t){for(var n in t)e[n]=t[n];return e},copy:function(e){var t={};for(var n in e)t[n]=e[n];return t},createClass:function(e,t,n){for(var s=e.split("."),r=window,o=0;o<s.length-1;++o)void 0===r[s[o]]&&(r[s[o]]={}),r=r[s[o]];var i=s[s.length-1],l=void 0===r[i]?void 0:r[i];if(r[i]=t,r[i].prototype=n,r[i].prototype.constructor=t,l)for(var c in l)r[i][c]=l[c];return r[i]._lcClass=e,r[i]._lcExtends=[],parent[i]},extendClass:function(e,t,n,s){for(var r=e.split("."),o=window,i=0;i<r.length-1;++i)void 0===o[r[i]]&&(o[r[i]]={}),o=o[r[i]];var l=r[r.length-1],c=void 0===o[l]?void 0:o[l];if(o[l]=n,c)for(var a in c)o[l][a]=c[a];o[l]._lcClass=e,o[l]._lcExtends=[],Array.isArray(t)||(t=[t]);var u={};for(i=0;i<t.length;++i){if(!t[i])throw new Error("Undefined extended class (index "+i+") for "+e);if(void 0===t[i]._lcClass)throw new Error("Not a valid class to extend: "+t[i]+" (when defining class "+e+")");if(lc.core.merge(u,t[i].prototype),o[l]._lcExtends.indexOf(t[i])<0&&o[l]._lcExtends.push(t[i]._lcClass),t[i]._lcExtends)for(var h=0;h<t[i]._lcExtends.length;++h)o[l]._lcExtends.indexOf(t[i]._lcExtends[h])<0&&o[l]._lcExtends.push(t[i]._lcExtends[h])}for(var a in u)void 0===s[a]&&(s[a]=u[a]);return o[l].prototype=s,o[l].prototype.constructor=n,o[l]},fromName:function(e){return lc.core._fromName(window,e)},_fromName:function(e,t){if(void 0!==e[t])return e[t];for(var n=0;n<t.length;){var s=t.indexOf(".",n);if(s<=0)return;if(void 0!==e[t.substring(0,s)]){var r=lc.core._fromName(e[t.substring(0,s)],t.substring(s+1));if(r)return r}n=s+1}},instanceOf:function(e,t){if("string"==typeof t&&(t=lc.core.fromName(t)),e instanceof t)return!0;if("function"!=typeof e.constructor)return!1;if(void 0===e.constructor._lcExtends)return!1;for(var n=0;n<e.constructor._lcExtends.length;++n)if(lc.core.fromName(e.constructor._lcExtends[n])==t)return!0;return!1},isExtending:function(e,t){if("string"==typeof e&&(e=lc.core.fromName(e)),"string"==typeof t&&(t=lc.core.fromName(t)),void 0===e._lcExtends)return!1;for(var n=0;n<e._lcExtends.length;++n)if(lc.core.fromName(e._lcExtends[n])==t)return!0;return!1},getExtendedClasses:function(e){if("function"!=typeof e.constructor)return[];if(void 0===e.constructor._lcExtends)return[];for(var t=[],n=0;n<e.constructor._lcExtends.length;++n)t.push(lc.core.fromName(e.constructor._lcExtends[n]));return t},typeOf:function(e){if(null===e)return"null";if("object"!=typeof e)return typeof e;if(e.constructor._lcClass)return e.constructor._lcClass;var t=e.constructor;if(t){if(t.name)return t.name;if(t.displayName)return t.displayName}return"[unknown]"},className:function(e){return e._lcClass},_idCounter:0,generateId:function(){return"id"+ ++lc.core._idCounter},getMyURL:function(){var t;try{toto.tutu()}catch(e){t=e.stack.split("\n")}for(var e=!0,n=0;n<t.length;++n)if(t[n].match(/http[s]?:\/\//)){if(!e){var s=t[n].match(/((http[s]?:\/\/.+\/)([^\/]+\.js)):/);return new lc.URL(s[1])}e=!1}return null}},lc.core.namespace("lc.app",{_expectedExpressions:[],_applicationListeners:[],onDefined:function(e,t){Array.isArray(e)||(e=[e]),lc.app._isDefined(e)?lc.async.Callback.callListeners(t):(lc.app._expectedExpressions.push({expressions:e,listener:t}),lc.log&&lc.log.trace("lc.app")&&lc.log.trace("lc.app","New waited expressions: "+e.length))},_isDefined:function(expressions){if(!lc.core._loaded)return!1;for(var i=0;i<expressions.length;++i){var value=void 0;try{value=eval("("+expressions[i]+")")}catch(e){}if(void 0===value)return!1}return!0},newDefinitionsAvailable:function(){if(0!=lc.app._expectedExpressions.length){var e;lc.log&&lc.log.trace("lc.app")&&lc.log.trace("lc.app","newDefinitionsAvailable: waiting = "+lc.app._expectedExpressions.length);do{e=lc.app._expectedExpressions.length;for(var t=0;t<lc.app._expectedExpressions.length;++t)lc.app._isDefined(lc.app._expectedExpressions[t].expressions)&&(lc.async.Callback.callListeners(lc.app._expectedExpressions[t].listener),lc.app._expectedExpressions.splice(t,1),t--)}while(0<e&&lc.app._expectedExpressions.length!=e);lc.log&&lc.log.trace("lc.app")&&lc.log.trace("lc.app","Still waiting for expressions: "+lc.app._expectedExpressions.length)}},onLoaded:function(e){null===lc.app._applicationListeners?lc.async.Callback.callListeners(e):lc.app._applicationListeners.push(e)},loaded:function(){lc.app.newDefinitionsAvailable(),lc.async.Callback.callListeners(lc.app._applicationListeners),lc.app._applicationListeners=null,lc.app.newDefinitionsAvailable();for(var e=0;e<lc.app._expectedExpressions.length;++e)lc.log.warn("lc.app","Application loaded but still waiting for: "+lc.app._expectedExpressions[e].expressions);lc.log.debug("lc.app","Application loaded.")},_pending:[],_futureListeners:[],pending:function(e){lc.app._pending.push(e),1==lc.app._pending.length&&lc.app._working(),e.ondone(function(){lc.app._pending.remove(e),0==lc.app._pending.length&&lc.app._idle()}),lc.async.Callback.callListeners(lc.app._futureListeners,[e])},_idleListeners:[],_workingListeners:[],_idle:function(){lc.async.Callback.callListeners(lc.app._idleListeners)},_working:function(){lc.async.Callback.callListeners(lc.app._workingListeners)},addIdleListener:function(e){lc.app._idleListeners.push(e),0==lc.app._pending.length&&lc.async.Callback.callListeners(e)},removeIdleListener:function(e){lc.app._idleListeners.remove(e)},addWorkingListener:function(e){lc.app._workingListeners.push(e),0<lc.app._pending.length&&lc.async.Callback.callListeners(e)},removeWorkingListener:function(e){lc.app._workingListeners.remove(e)},addAsynchronousOperationListener:function(e){lc.app._futureListeners.push(e)},removeAsynchronousOperationListener:function(e){lc.app._futureListeners.remove(e)}}),window.addEventListener("load",function(){lc.app.newDefinitionsAvailable(),document.body.addEventListener("ready",lc.app.newDefinitionsAvailable)}),setTimeout(function(){0==lc.app._pending.length&&lc.app._idle()},1),lc.core.namespace("lc.animation",{animate:function(r,o,i){void 0===o&&(o="lc-animate-start",i="lc-animate-end");var l,c,a=new lc.async.Future,u=!1,e=!1;return l=function(){u=!0,r.removeEventListener("transitionstart",l)},c=function(){e||(lc.css.removeClass(r,"lc-animate"),lc.css.removeClass(r,i),r.removeEventListener("transitionend",c),r.removeEventListener("transitioncancel",c),e=!0,a.success())},r.addEventListener("transitionstart",l),r.addEventListener("transitionend",c),r.addEventListener("transitioncancel",c),lc.css.addClass(r,"lc-animate"),lc.css.addClass(r,o),setTimeout(function(){var e=getComputedStyle(r);if(e.transitionProperty&&(u=!0),!u)return lc.css.removeClass(r,"lc-animate"),lc.css.removeClass(r,o),r.removeEventListener("transitionstart",l),r.removeEventListener("transitionend",c),r.removeEventListener("transitioncancel",c),void a.success();lc.css.removeClass(r,o),lc.css.addClass(r,i);var t=e.transitionDuration,n=t.indexOf("ms"),s=t.indexOf("s");t=0<n&&n<s?parseInt(t.substring(0,n)):0<s?1e3*parseFloat(t.substring(0,s)):0,setTimeout(c,Math.floor(t+1))},1),a},animateReverse:function(e){return this.animate(e,"lc-animate-end","lc-animate-start")},timing:{linear:function(e,t,n,s){return e*n/s+t},easeInQuad:function(e,t,n,s){return n*(e/=s)*e+t},easeOutQuad:function(e,t,n,s){return-n*(e/=s)*(e-2)+t},easeInOutQuad:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,s){return n*(e/=s)*e*e+t},easeOutCubic:function(e,t,n,s){return n*((e=e/s-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,s){return n*(e/=s)*e*e*e+t},easeOutQuart:function(e,t,n,s){return-n*((e=e/s-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,s){return n*(e/=s)*e*e*e*e+t},easeOutQuint:function(e,t,n,s){return n*((e=e/s-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,s){return-n*Math.cos(e/s*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,s){return n*Math.sin(e/s*(Math.PI/2))+t},easeInOutSine:function(e,t,n,s){return-n/2*(Math.cos(Math.PI*e/s)-1)+t},easeInExpo:function(e,t,n,s){return 0==e?t:n*Math.pow(2,10*(e/s-1))+t},easeOutExpo:function(e,t,n,s){return e==s?t+n:n*(1-Math.pow(2,-10*e/s))+t},easeInOutExpo:function(e,t,n,s){return 0==e?t:e==s?t+n:(e/=s/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(2-Math.pow(2,-10*--e))+t},easeInCirc:function(e,t,n,s){return-n*(Math.sqrt(1-(e/=s)*e)-1)+t},easeOutCirc:function(e,t,n,s){return n*Math.sqrt(1-(e=e/s-1)*e)+t},easeInOutCirc:function(e,t,n,s){return(e/=s/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,n,s){var r=1.70158,o=0,i=n;if(0==e)return t;if(1==(e/=s))return t+n;if(o||(o=.3*s),i<Math.abs(n)){i=n;r=o/4}else r=o/(2*Math.PI)*Math.asin(n/i);return-i*Math.pow(2,10*(e-=1))*Math.sin((e*s-r)*(2*Math.PI)/o)+t},easeOutElastic:function(e,t,n,s){var r=1.70158,o=0,i=n;if(0==e)return t;if(1==(e/=s))return t+n;if(o||(o=.3*s),i<Math.abs(n)){i=n;r=o/4}else r=o/(2*Math.PI)*Math.asin(n/i);return i*Math.pow(2,-10*e)*Math.sin((e*s-r)*(2*Math.PI)/o)+n+t},easeInOutElastic:function(e,t,n,s){var r=1.70158,o=0,i=n;if(0==e)return t;if(2==(e/=s/2))return t+n;if(o||(o=s*(.3*1.5)),i<Math.abs(n)){i=n;r=o/4}else r=o/(2*Math.PI)*Math.asin(n/i);return e<1?i*Math.pow(2,10*(e-=1))*Math.sin((e*s-r)*(2*Math.PI)/o)*-.5+t:i*Math.pow(2,-10*(e-=1))*Math.sin((e*s-r)*(2*Math.PI)/o)*.5+n+t},easeInBack:function(e,t,n,s,r){return null==r&&(r=1.70158),n*(e/=s)*e*((r+1)*e-r)+t},easeOutBack:function(e,t,n,s,r){return null==r&&(r=1.70158),n*((e=e/s-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(e,t,n,s,r){return null==r&&(r=1.70158),(e/=s/2)<1?n/2*(e*e*((1+(r*=1.525))*e-r))+t:n/2*((e-=2)*e*((1+(r*=1.525))*e+r)+2)+t},easeInBounce:function(e,t,n,s){return n-lc.animation.functions.easeOutBounce(s-e,0,n,s)+t},easeOutBounce:function(e,t,n,s){return(e/=s)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(e,t,n,s){return e<s/2?.5*lc.animation.functions.easeInBounce(2*e,0,n,s)+t:.5*lc.animation.functions.easeOutBounce(2*e-s,0,n,s)+.5*n+t}},collapseHeight:function(e,t){e.style.transitionProperty="height,transform,padding",e.style.transitionDuration=t+"ms",e.style.transitionTimingFunction="ease-in-out",e.style.transformOrigin="top",e.style.overflow="hidden";var n=getComputedStyle(e);e.style.paddingTop=n.paddingTop,e.style.paddingBottom=n.paddingBottom;var s=parseInt(n.paddingTop);isNaN(s)&&(s=0);var r=parseInt(n.paddingBottom);isNaN(r)&&(r=0),e.style.height=e.clientHeight-s-r+"px",e.style.transform="scaleY(1)";var o=new lc.async.Future;return setTimeout(function(){e.style.height="0px",e.style.transform="scaleY(0)",e.style.paddingTop="0px",e.style.paddingBottom="0px",setTimeout(function(){e.style.height="",e.style.transform="",e.style.paddingTop="",e.style.paddingBottom="",e.style.transitionProperty="",e.style.transitionDuration="",e.style.transitionTimingFunction="",e.style.overflow="",o.success()},t)},0),o},expandHeight:function(n,s){var r=getComputedStyle(n);n.style.paddingTop="0px",n.style.paddingBottom="0px";var o=n.clientHeight;n.style.transitionProperty="height,transform,padding",n.style.transitionDuration=s+"ms",n.style.transitionTimingFunction="ease-in-out",n.style.transformOrigin="top",n.style.overflow="hidden",n.style.height="0px",n.style.transform="scaleY(0)";var i=new lc.async.Future;return setTimeout(function(){n.style.paddingTop=r.paddingTop,n.style.paddingBottom=r.paddingBottom;var e=parseInt(r.paddingTop);isNaN(e)&&(e=0);var t=parseInt(r.paddingBottom);isNaN(t)&&(t=0),n.style.height=o-e-t+"px",n.style.transform="scaleY(1)",setTimeout(function(){n.style.height="",n.style.transform="",n.style.paddingTop="",n.style.paddingBottom="",n.style.transitionProperty="",n.style.transitionDuration="",n.style.transitionTimingFunction="",n.style.overflow="",i.success()},s)},0),i},collapseWidth:function(e,t){e.style.transitionProperty="width,transform,padding",e.style.transitionDuration=t+"ms",e.style.transitionTimingFunction="ease-in-out",e.style.transformOrigin="left",e.style.overflow="hidden";var n=getComputedStyle(e);e.style.paddingLeft=n.paddingLeft,e.style.paddingRight=n.paddingRight;var s=parseInt(n.paddingTop);isNaN(s)&&(s=0);var r=parseInt(n.paddingBottom);isNaN(r)&&(r=0),e.style.width=e.clientWidth-s-r+"px",e.style.transform="scaleX(1)";var o=new lc.async.Future;return setTimeout(function(){e.style.width="0px",e.style.transform="scaleX(0)",e.style.paddingLeft="0px",e.style.paddingRight="0px",setTimeout(function(){e.style.width="",e.style.transform="",e.style.paddingLeft="",e.style.paddingRight="",e.style.transitionProperty="",e.style.transitionDuration="",e.style.transitionTimingFunction="",e.style.overflow="",o.success()},t)},0),o},expandWidth:function(n,s){var r=getComputedStyle(n),o=n.clientWidth;n.style.transitionProperty="width,transform,padding",n.style.transitionDuration=s+"ms",n.style.transitionTimingFunction="ease-in-out",n.style.transformOrigin="left",n.style.overflow="hidden",n.style.width="0px",n.style.transform="scaleY(0)",n.style.paddingLeft="0px",n.style.paddingRight="0px";var i=new lc.async.Future;return setTimeout(function(){n.style.paddingLeft=r.paddingLeft,n.style.paddingRight=r.paddingRight;var e=parseInt(r.paddingLeft);isNaN(e)&&(e=0);var t=parseInt(r.paddingRight);isNaN(t)&&(t=0),n.style.width=o-e-t+"px",n.style.transform="scaleY(1)",setTimeout(function(){n.style.width="",n.style.transform="",n.style.paddingLeft="",n.style.paddingRight="",n.style.transitionProperty="",n.style.transitionDuration="",n.style.transitionTimingFunction="",n.style.overflow="",i.success()},s)},0),i}}),lc.core.createClass("lc.animation.AnimatedElement",function(e,t,n){this._element=e,t||(t=lc.animation.timing.easeInOutCubic),this._timing=t,(!n||n<=0)&&(n=100),this._duration=n,this._properties=[],this._listeners=[]},{_start:-1,_forward:!0,_timeout:null,addProperty:function(e,t,n,s,r){this._properties.push({name:e,start:t,end:n,prefix:s,suffix:r})},addListener:function(e){this._listeners.push(lc.async.Callback.from(e))},setTimingFunction:function(e){e||(e=lc.animation.timing.easeInOutCubic),this._timing=e},setDuration:function(e){(!e||e<=0)&&(e=100),this._duration=e},forward:function(){var e=(new Date).getTime();if(null!=this._timeout)this._forward||(this._forward=!0,this._start=e-(this._start+this._duration-e));else{this._forward=!0,this._start=e,this._applyValues(0);var t=this;this._timeout=setTimeout(function(){t._update()},1)}},backward:function(){var e=(new Date).getTime();if(null!=this._timeout)this._forward&&(this._forward=!1,this._start=e-(this._start+this._duration-e));else{this._forward=!1,this._start=e,this._applyValues(this._duration);var t=this;this._timeout=setTimeout(function(){t._update()},1)}},_update:function(){var e=(new Date).getTime();if(e>=this._start+this._duration)return this._forward?this._applyValues(this._duration):this._applyValues(0),this._start=-1,void(this._timeout=null);this._forward?this._applyValues(e-this._start):this._applyValues(this._duration-(e-this._start));var t=this;this._timeout=setTimeout(function(){t._update()},10)},_applyValues:function(e){for(var t=this._timing(e,0,1,this._duration),n=0;n<this._properties.length;++n){var s=this._properties[n];this._element.style[s.name]=s.prefix+(s.start+(s.end-s.start)*t)+s.suffix}lc.async.Callback.callListeners(this._listeners,[this._element,t])}}),lc.core.createClass("lc.async.Callback",function(e,t,n){this._this=e,this._fct=t,this._args=n},{call:function(){for(var e=[],t=0;t<arguments.length;++t)e.push(arguments[t]);return this._args&&(e=this._args.concat(e)),this._fct.apply(this._this,e)},apply:function(e){var t=[];if(e)for(var n=0;n<e.length;++n)t.push(e[n]);return this._args&&(t=this._args.concat(t)),this._fct.apply(this._this,t)},toFunction:function(){var e=this;return function(){return e.apply(arguments)}}}),lc.async.Callback.callListeners=function(t,e){t=Array.isArray(t)?t.slice():[t],void 0===e&&(e=[]);for(var n=0;n<t.length;++n)try{if("function"==typeof t[n])t[n].apply(null,e);else{if(!lc.core.instanceOf(t[n],lc.async.Callback))throw new Error("Unexpected listener type: "+lc.core.typeOf(t[n]));t[n].apply(e)}}catch(e){lc.log.error("lc.async.Callback",(lc.core.instanceOf(t[n],lc.async.Callback),t[n]._fct),e)}},lc.async.Callback.from=function(e){if("function"==typeof e)return new lc.async.Callback(window,e);if(lc.core.instanceOf(e,lc.async.Callback))return e;throw new Error("Unexpected type: "+lc.core.typeOf(e))},lc.core.createClass("lc.async.Future",function(){this._successListeners=[],this._errorListeners=[],this._doneListeners=[]},{_done:!1,_result:void 0,_error:void 0,_successListeners:null,_errorListeners:null,_doneListeners:null,success:function(e){if(this._done)throw new Error("Future already done");this._result=e,this._done=!0,this._callListeners()},error:function(e){if(this._done)throw new Error("Future already done");this._error=e,this._done=!0,this._callListeners()},ondone:function(e){return this._done?lc.async.Callback.callListeners([e],[]):this._doneListeners.push(e),this},onsuccess:function(t){return lc.core.instanceOf(t,lc.async.Future)?onsuccess(function(e){t.success(e)}):(this._done?void 0===this._error&&lc.async.Callback.callListeners([t],[this._result]):this._successListeners.push(t),this)},onerror:function(t){return lc.core.instanceOf(t,lc.async.Future)?this.onerror(function(e){t.error(e)}):(this._done?null!=this._error&&lc.async.Callback.callListeners([t],[this._error]):this._errorListeners.push(t),this)},isDone:function(){return this._done},getResult:function(){return this._result},getError:function(){return this._error},forwardTo:function(t){this.onsuccess(function(e){t.success(e)}),this.onerror(function(e){t.error(e)})},_callListeners:function(){void 0===this._error?lc.async.Callback.callListeners(this._successListeners,[this._result]):lc.async.Callback.callListeners(this._errorListeners,[this._error]),lc.async.Callback.callListeners(this._doneListeners,[]),this._doneListeners=null,this._successListeners=null,this._errorListeners=null}}),lc.async.Future.alreadySuccess=function(e){var t=new lc.async.Future;return t.success(e),t},lc.async.Future.alreadyError=function(e){var t=new lc.async.Future;return t.error(e),t},lc.core.extendClass("lc.async.JoinPoint",lc.async.Future,function(){lc.async.Future.call(this),this._remaining=0,this._started=!1},{addToJoin:function(e){if("number"==typeof e)this._remaining+=e;else{if(!lc.core.instanceOf(e,lc.async.Future))throw"Unexpected type to join: "+lc.core.typeOf(e);this._remaining++,e.onsuccess(new lc.async.Callback(this,this.join)).onerror(new lc.async.Callback(this,this.error))}},start:function(){this._started=!0,this._check()},join:function(){if(this._remaining<=0)throw"JoinPoint: no more join expected";this._remaining--,this._started&&this._check()},_check:function(){this._done||this._remaining<=0&&this.success(null)}}),lc.async.JoinPoint.from=function(){for(var e=new lc.async.JoinPoint,t=0;t<arguments.length;++t)e.addToJoin(arguments[t]);return e.start(),e},lc.core.createClass("lc.Cache",function(e,t,n){if(this._timeout=e,this._onrelease=t,0<e){(n<=0||!n)&&(n=3e4);var s=this;this._interval=setInterval(function(){lc.log.trace("lc.Cache")&&lc.log.trace("lc.Cache","Check cache timeout"),s._checkTimeout()},n)}},{_items:new Map,set:function(e,t){var n=this._items.get(e);n&&this._onrelease&&this._onrelease(e,n.item),this._items.set(e,{item:t,used:(new Date).getTime()})},get:function(e){var t=this._items.get(e);if(t)return t.used=(new Date).getTime(),t.item},remove:function(e){var t=this._items.get(e);return!!t&&(this._onrelease&&this._onrelease(e,t.item),this._items.delete(e),!0)},clear:function(){this._onrelease&&this._items.forEach(function(e,t,n){this._onrelease(t,e.item)},this),this._items.clear()},close:function(){this._interval&&(clearInterval(this._interval),this._interval=null),this.clear(),this._items=null},_checkTimeout:function(){var s=(new Date).getTime()-this._timeout,r=this._onrelease;this._items.forEach(function(e,t,n){e.used<s&&(r&&r(t,e.item),n.delete(t))})}}),lc.core.createClass("lc.Configurable",function(e){for(var t in e||(e={}),e){var n=e[t],s={enumerable:!0};n.get?s.get=new Function('return this.configurableProperties["'+t+'"].get.call(this, this.configurableProperties);'):s.get=new Function('return this.configurableProperties["'+t+'"].value;'),n.set?s.set=new Function("value",'return this.configurableProperties["'+t+'"].set.call(this, value, this.configurableProperties);'):s.set=new Function("value",'return this.configurableProperties["'+t+'"].value = value;'),void 0!==n.writable&&(s.writable=n.writable),Object.defineProperty(this,t,s)}this.configurableProperties=e},{configurableProperties:{}}),lc.app.onDefined(["lc.events","lc.async.Callback"],function(){"use strict";lc.core.createClass("lc.Context",function(e){(e._lc_context=this).element=e,Object.defineProperty(this,"_values",{enumerable:!1,writable:!1,value:{}}),Object.defineProperty(this,"events",{enumerable:!1,writable:!1,value:new lc.events.Producer}),Object.defineProperty(this,"addProperty",{enumerable:!1,writable:!1,configurable:!1,value:lc.Context.prototype.addProperty}),Object.defineProperty(this,"removeProperty",{enumerable:!1,writable:!1,configurable:!1,value:lc.Context.prototype.removeProperty}),Object.defineProperty(this,"setProperty",{enumerable:!1,writable:!1,configurable:!1,value:lc.Context.prototype.setProperty}),Object.defineProperty(this,"hasProperty",{enumerable:!1,writable:!1,configurable:!1,value:lc.Context.prototype.hasProperty}),Object.defineProperty(this,"getProperty",{enumerable:!1,writable:!1,configurable:!1,value:lc.Context.prototype.getProperty}),this.events.registerEvents(["propertyAdded","propertyRemoved","propertySet","changed","destroyed"]),lc.Context.globalEvents.trigger("contextCreated",[this]),lc.events.listen(e,"destroy",new lc.async.Callback(this,function(){e._lc_context=null,this.events.trigger("destroyed",[this]),lc.Context.globalEvents.trigger("contextDestroyed",[this]),this.element=null}))},{addProperty:function(t,e){if(void 0!==this._values[t])throw"Property "+t+" already exists";this._values[t]=e,Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:function(){return this._values[t]},set:function(e){e!==this._values[t]&&(this._values[t]=e,this.events.trigger("propertySet",[this,t,e]),lc.Context.globalEvents.trigger("propertySet",[this,t,e]),this.events.trigger("changed",[this]),lc.Context.globalEvents.trigger("changed",[this]))}}),this.events.trigger("propertyAdded",[this,t,e]),lc.Context.globalEvents.trigger("propertyAdded",[this,t,e]),this.events.trigger("changed",[this]),lc.Context.globalEvents.trigger("changed",[this])},removeProperty:function(e){void 0!==this._values[e]&&(delete this._values[e],delete this[e],this.events.trigger("propertyRemoved",[this,e]),lc.Context.globalEvents.trigger("propertyRemoved",[this,e]),this.events.trigger("changed",[this]),lc.Context.globalEvents.trigger("changed",[this]))},setProperty:function(e,t){void 0!==this._values[e]?this[e]=t:this.addProperty(e,t)},hasProperty:function(e){return void 0!==this._values[e]},getProperty:function(e){if(void 0!==this._values[e])return this._values[e]}}),lc.Context.get=function(e,t){return void 0===e._lc_context?t?null:new lc.Context(e):e._lc_context},lc.Context.getValue=function(e,t){var n=lc.Context.get(e,!0);if(n)return n.getProperty(t)},lc.Context.searchValue=function(e,t){do{var n=lc.Context.get(e,!0);if(n&&n.hasProperty(t))return n.getProperty(t);e=e.parentNode}while(e)},lc.Context.aggregate=function(e){var t={};do{var n=lc.Context.get(e,!0);if(n)for(var s in n)void 0===t[s]&&(t[s]=n[s]);e=e.parentNode}while(e&&"HTML"!=e.nodeName);return t},lc.Context.globalEvents=new lc.events.Producer,lc.Context.globalEvents.registerEvents(["propertyAdded","propertyRemoved","propertySet","changed","contextCreated","contextDestroyed"])}),lc.core.namespace("lc.cookies",{get:function(e){return document.cookie.replace(new RegExp("(?:(?:^|.*;s*)"+e+"s*=s*([^;]*).*$)|^.*$"),"$1")},set:function(e,t,n,s){var r=e+"="+t;n&&(r+=";path="+n),s&&(r+=";max-age="+s),document.cookie=r}}),lc.core.namespace("lc.css",{hasClass:function(e,t){return e.className.split(" ").contains(t)},addClass:function(e,t){""!=e.className?e.className.split(" ").contains(t)||(e.className+=" "+t):e.className=t},removeClass:function(e,t){if(""!=e.className)if(e.className!=t){var n=e.className.split(" ");n.contains(t)&&(n.remove(t),e.className=n.join(" "))}else e.className=""},getClasses:function(e){return e.className.split(" ")}}),lc.core.namespace("lc.events",{_customEvents:{destroy:function(e,t){}},registerCustomEvent:function(e,t){t||(t=function(e,t){}),void 0===lc.events._customEvents[e]&&(lc.events._customEvents[e]=t)},triggerCustomEvent:function(e,t,n){if(e._eventListeners)for(var s=0;s<e._eventListeners.length;++s)e._eventListeners[s].eventType==t&&lc.async.Callback.callListeners(e._eventListeners[s].listener,n)},listen:function(e,t,n,s){if(!n)throw new Error("No listener given to lc.events.listen");e._eventListeners||(e._eventListeners=[]),"function"==typeof n&&(n=new lc.async.Callback(e,n));var r={eventType:t,listener:n};e._eventListeners.push(r),void 0===lc.events._customEvents[t]?(r.listenerFct=r.listener.toFunction(),e.addEventListener(t,r.listenerFct,s)):lc.events._customEvents[t](e,n)},unlisten:function(e,t,n,s){if(e._eventListeners)for(var r=0;r<e._eventListeners.length;++r)if(e._eventListeners[r].eventType==t&&(e._eventListeners[r].listener==n||e._eventListeners[r].listener._fct==n)){n=e._eventListeners[r].listenerFct,e._eventListeners[r].listener=null,e._eventListeners.splice(r,1);break}void 0===lc.events._customEvents[t]&&e.removeEventListener(t,n,s)},destroyed:function(e){if(!e._destroyed){if(e._destroyed=!0,e._eventListeners){var t=e._eventListeners.slice();e._eventListeners=null;for(var n=0;n<t.length;++n)"destroy"===t[n].eventType?lc.async.Callback.callListeners(t[n].listener):void 0===lc.events._customEvents[t[n].eventType]&&e.removeEventListener(t[n].eventType,t[n].listener._fct),t[n].listener=null}if(e.childNodes)for(n=0;n<e.childNodes.length;++n)lc.events.destroyed(e.childNodes[n])}}}),lc.app.onDefined("lc.html",function(){lc.html.addCloneHandler(function(e,t){if(t._eventListeners){t._eventListeners=t._eventListeners.slice();for(var n=0;n<t._eventListeners.length;++n){var s=t._eventListeners[n];if(t._eventListeners[n]={eventType:s.eventType,listener:new lc.async.Callback(s.listener.objThis,s.listener.fct,s.listener.args)},t._eventListeners[n].listener.objThis==e&&(t._eventListeners[n].listener.objThis=t),t._eventListeners[n].listener.args)for(var r=0;r<t._eventListeners[n].listener.args.length;++r)t._eventListeners[n].listener.args[r]==e&&(t._eventListeners[n].listener.args[r]=t)}}})}),lc.core.createClass("lc.events.Producer",function(){this.eventsListeners||(this.eventsListeners={},this.listen=this.on)},{registerEvent:function(e){e=e.toLowerCase(),this.eventsListeners[e]=[],lc.log.trace("lc.events.Producer")&&lc.log.trace("lc.events.Producer","Event registered: "+e)},registerEvents:function(e){for(var t=0;t<e.length;++t)this.registerEvent(e[t])},unregisterEvents:function(e){for(var t=0;t<e.length;++t)delete this.eventsListeners[e[t].toLowerCase()]},on:function(e,t){if(e=e.toLowerCase(),void 0===this.eventsListeners[e])throw new Error("Unknown event: "+e);this.eventsListeners[e].push(t)},unlisten:function(e,t){if(e=e.toLowerCase(),void 0===this.eventsListeners[e])throw new Error("Unknown event: "+e);for(var n=0;n<this.eventsListeners[e].length;++n)if(this.eventsListeners[e][n]==t){this.eventsListeners[e].splice(n,1);break}},trigger:function(e,t){if(this.eventsListeners){if(e=e.toLowerCase(),void 0===this.eventsListeners[e])throw new Error("Unknown event: "+e);lc.log.debug("lc.events.Producer")&&lc.log.debug("lc.events.Producer",e+" on "+lc.core.typeOf(this)+" ("+this.eventsListeners[e].length+" listeners)"),lc.async.Callback.callListeners(this.eventsListeners[e],t)}},hasEvent:function(e){return e=e.toLowerCase(),void 0!==this.eventsListeners[e]},createListenersFromElement:function(e){if(e&&1==e.nodeType)for(var t=0;t<e.attributes.length;++t){var n=e.attributes.item(t);if(n.nodeName.startsWith("on-")){var s=n.nodeName.substring(3);if(this.hasEvent(s))try{var r=new Function(n.nodeValue);this.listen(s,new lc.async.Callback(this,r))}catch(e){lc.log.error("lc.events.Producer","Invalid event listener function from attribute "+n.nodeName+": "+n.nodeValue,e)}else lc.log.warn("lc.events.Producer","Unknown event from attribute "+n.nodeName)}}},destroy:function(){this.eventsListeners=null}}),lc.core.createClass("lc.Extendable",function(){null===this.extensions&&(this.extensions=[],this._overrides={},lc.Extension.Registry.detect(this),this.extensions.sort(function(e,t){return t.priority-e.priority}))},{extensions:null,addExtension:function(t){if(null==this.getExtension(t)){try{t=new t}catch(e){return void lc.log.error("lc.Extendable","Error instantiating extension "+t+": "+e,e)}this.extensions.push(t);try{t.init(this)}catch(e){lc.log.error("lc.Extendable","Error initializing extension "+lc.core.typeOf(t)+": "+e,e)}return this.extensionAdded(t),t}},extensionAdded:function(e){},removeExtension:function(e){var t=!1;if("function"==typeof e){for(var n=0;n<this.extensions.length;++n)if(lc.core.instanceOf(this.extensions[n],e)){e=this.extensions[n],this.extensions.splice(n,1),t=!0;break}}else for(n=0;n<this.extensions.length;++n)if(this.extensions[n]==e){this.extensions.splice(n,1),t=!0;break}if(t){for(var s in this._overrides){var r=this._overrides[s];for(n=1;n<r.length;++n)if(r[n].extension===e&&r[n].impl&&(r.splice(n,1),1==r.length)){this[s]=r[0].impl,delete this._overrides[s];break}}e.destroy(this)}},getExtension:function(e){for(var t=0;t<this.extensions.length;++t)if(lc.core.instanceOf(this.extensions[t],e))return this.extensions[t];return null},hasExtension:function(e){return null!=this.getExtension(e)},callExtensions:function(t){if(this.extensions)for(var e=Array.prototype.slice.call(arguments,1),n=0;n<this.extensions.length;++n)if("function"==typeof this.extensions[n][t])try{if(this.extensions[n][t].apply(this.extensions[n],e),!this.extensions)return}catch(e){lc.log.error("lc.Extandable","Error calling method "+t+" on extension "+lc.core.typeOf(this.extensions[n])+": "+e,e)}},extensionOverridesMethod:function(e,t,n){void 0===this._overrides[t]&&(this._overrides[t]=[{extension:null,impl:this[t]}],this[t]=function(){return this._callOverriddenMethod(t,arguments)}),this._overrides[t].push({extension:e,impl:n})},_callOverriddenMethod:function(e,t){var n=this._overrides[e];return n[n.length-1].impl.apply(this,t)},callPreviousImplementation:function(e,t,n){for(var s=this._overrides[t],r=s.length-1;0<=r&&s[r].extension!=e;)r--;if(!(r<=0))return s[r-1].impl.apply(this,n)},destroy:function(){if(this.extensions){for(var e=0;e<this.extensions.length;++e)this.extensions[e].destroy(this);this.extensions=null}}}),lc.core.createClass("lc.Extension",function(){},{priority:0,detect:function(e){},init:function(e){},destroy:function(e){}}),lc.Extension.Registry={_extensions:[],register:function(e,t){lc.log.trace("lc.Extension")&&lc.log.trace("lc.Extension","Extension registered: "+lc.core.className(t)+" extending "+lc.core.className(e)),this._extensions.push({extended:e,extension:t})},detect:function(e){for(var t=0;t<this._extensions.length;++t)lc.core.instanceOf(e,this._extensions[t].extended)&&this._extensions[t].extension.prototype.detect(e)&&e.addExtension(this._extensions[t].extension)},getAvailableFor:function(e){for(var t=[],n=0;n<this._extensions.length;++n)(this._extensions[n].extended===e||lc.core.isExtending(e,this._extensions[n].extended))&&t.push(this._extensions[n].extension);return t}},lc.core.namespace("lc.html",{walkChildren:function(e,t){for(var n=0;n<e.childNodes.length;++n)lc.Callback.from(t).call(e.childNodes[n])||1==e.childNodes[n].nodeType&&lc.html.walkChildren(e.childNodes[n],t)},create:function(e,t){var n=document.createElement(e);if(t)for(var s in t)n[s]=t[s];return n},remove:function(e){lc.events.destroyed(e),e.parentNode&&e.parentNode.removeChild(e)},empty:function(e){for(;0<e.childNodes.length;)lc.html.remove(e.childNodes[0])},addOption:function(e,t,n){var s=document.createElement("OPTION");s.value=t,s.text=n,e.add(s)},insertAfter:function(e,t){return t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)},removeChildrenAfter:function(e){for(;e.nextSibling;)lc.html.remove(e.nextSibling)},escape:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},_cloneHandlers:[],addCloneHandler:function(e){lc.html._cloneHandlers.push(e)},clone:function(e){var t=e.cloneNode(!0);return lc.html._clone(e,t),t},_clone:function(e,t){for(var n=0;n<lc.html._cloneHandlers.length;++n)lc.html._cloneHandlers[n](e,t);for(n=0;n<e.childNodes.length;++n)lc.html._clone(e.childNodes[n],t.childNodes[n])}}),lc.core.namespace("lc.html.processor",{_preprocessors:[],_postprocessors:[],addPreProcessor:function(e,t){t||(t=1e3),lc.html.processor._preprocessors.push({processor:e,priority:t}),lc.html.processor._preprocessors.sort(function(e,t){return t.priority-e.priority})},addPostProcessor:function(e,t){t||(t=1e3),lc.html.processor._postprocessors.push({processor:e,priority:t}),lc.html.processor._postprocessors.sort(function(e,t){return t.priority-e.priority})},removePreProcessor:function(e){for(var t=0;t<lc.html.processor._preprocessors.length;++t)if(lc.html.processor._preprocessors[t].processor===e)return void lc.html.processor._preprocessors.splice(t,1)},removePostProcessor:function(e){for(var t=0;t<lc.html.processor._postprocessors.length;++t)if(lc.html.processor._postprocessors[t].processor===e)return void lc.html.processor._postprocessors.splice(t,1)},removeProcessor:function(e){lc.html.processor.removePreProcessor(e),lc.html.processor.removePostProcessor(e)},STATE_RUNNING:0,STATE_INTERRUPTED:1,STATE_STOPPED:2,process:function(e){var t=new lc.html.processor.Status(e);return t._continueProcessing(),t.result},processContent:function(e){var t=new lc.html.processor.Status(e);return t._elements[0]._preprocessors=[],t._elements[0]._postprocessors=[],t._continueProcessing(),t.result}}),lc.core.createClass("lc.html.processor.Status",function(e){this._elements=[new lc.html.processor.ElementStatus(e,this)],this.result=new lc.async.Future},{stop:function(){this._state=lc.html.processor.STATE_STOPPED},_state:lc.html.processor.STATE_RUNNING,_continueProcessing:function(){if(this.result.isDone())throw new Error("Processing is already terminated.");for(;;){if(this._state==lc.html.processor.STATE_STOPPED){for(;0<this._elements.length;){var e=this._elements[this._elements.length-1];this._elements.splice(this._elements.length-1,1),e.result.success(e)}return void this.result.success(this)}if(0==this._elements.length)return void this.result.success(this);if((e=this._elements[this._elements.length-1])._state==lc.html.processor.STATE_INTERRUPTED)return;if(e._state!=lc.html.processor.STATE_STOPPED)if(0<e._preprocessors.length){var t=e._preprocessors[0];e._preprocessors.splice(0,1),lc.async.Callback.callListeners(t.processor,[e.element,e,this])}else{if(void 0===e._children){e._children=[];for(var n=0;n<e.element.childNodes.length;++n)e._children.push(e.element.childNodes[n])}if(0<e._children.length){var s=e._children[0];e._children.splice(0,1);var r=new lc.html.processor.ElementStatus(s,this);this._elements.push(r)}else if(void 0===e._postprocessors&&(e._postprocessors=lc.html.processor._postprocessors.slice()),0<e._postprocessors.length){t=e._postprocessors[0];e._postprocessors.splice(0,1),lc.async.Callback.callListeners(t.processor,[e.element,e,this])}else e.result.success(e),this._elements.splice(this._elements.length-1,1),lc.events.triggerCustomEvent(e.element,"processed")}else e.result.success(e),this._elements.splice(this._elements.length-1,1)}}}),lc.core.createClass("lc.html.processor.ElementStatus",function(e,t){this.element=e,this._mainStatus=t,this._state=lc.html.processor.STATE_RUNNING,this._preprocessors=lc.html.processor._preprocessors.slice(),this._children=void 0,this._postprocessors=void 0,this.result=new lc.async.Future},{interrupt:function(){this._state=lc.html.processor.STATE_INTERRUPTED},stop:function(){this._state=lc.html.processor.STATE_STOPPED},resume:function(){this._state=lc.html.processor.STATE_RUNNING,this._mainStatus._continueProcessing()}}),lc.events.registerCustomEvent("processed",function(e,t){}),lc.core.namespace("lc.http",{request:function(e,t){t instanceof lc.URL&&(t=t.toString());var n=new XMLHttpRequest;return n.open(e,t,!0),n},get:function(e,t){var n=lc.http.request("GET",e);t&&n.setRequestHeader("Accept",t),n.send();var s=new lc.async.Future;return n.future.onsuccess(function(e){200==e.status?s.success(e.responseText):s.error(e.status)}),s},_customizers:[],_customize:function(e){for(var t=0;t<lc.http._customizers.length;++t)lc.http._customizers[t](e)},addCustomizer:function(e){lc.http._customizers.push(e)},removeCustomizer:function(e){lc.http._customizers.remove(e)}}),lc.http.addCustomizer(function(e){lc.log.trace("lc.http")&&lc.log.trace("lc.http","Sending HTTP Request "+e._http_method+" "+e._http_url),e.future=new lc.async.Future,e.addEventListener("readystatechange",function(){4==e.readyState&&(lc.log.trace("lc.http")&&lc.log.trace("lc.http","HTTP Response received: "+e._http_method+" "+e._http_url+" => "+e.status+" "+e.statusText),e.future.success(e))})}),window._lc_http_XMLHttpRequest_open=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,t,n,s,r){window._lc_http_XMLHttpRequest_open.apply(this,[e,t,n,s,r]),this._http_method=e,this._http_url=t},window._lc_http_XMLHttpRequest_send=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(e){lc.http._customize(this),lc.app.pending(this.future),window._lc_http_XMLHttpRequest_send.apply(this,[e])},lc.core.namespace("lc.http.rest",{defaultFormat:"json",formats:{json:{mime:"application/json",toString:function(e){return JSON.stringify(e)},fromString:function(e){if(0!=e.length)return JSON.parse(e)}}},get:function(e,t){t||(t=lc.http.rest.defaultFormat);var n=new lc.async.Future,s=lc.http.request("GET",e);return s.setRequestHeader("Accept",lc.http.rest.formats[t].mime),s.send(),lc.http.rest._waitResponse(s,t,n),n},post:function(e,t,n){return lc.http.rest._method("POST",e,t,n)},put:function(e,t,n){return lc.http.rest._method("PUT",e,t,n)},del:function(e,t,n){return lc.http.rest._method("DELETE",e,t,n)},handleResponseStatus:function(e,t){return!1},_method:function(e,t,n,s){s||(s=lc.http.rest.defaultFormat);var r=new lc.async.Future,o=lc.http.request(e,t);o.setRequestHeader("Accept",lc.http.rest.formats[s].mime);var i=n?lc.http.rest.formats[s].toString(n):null;return i&&o.setRequestHeader("Content-Type",lc.http.rest.formats[s].mime),lc.log.trace("lc.http.rest")&&lc.log.trace("lc.http.rest",e+" "+t+" ("+s+")"),o.send(i),lc.http.rest._waitResponse(o,s,r),r},_waitResponse:function(e,n,s){e.future.onerror(s).onsuccess(function(e){if(!lc.http.rest.handleResponseStatus(e,s))try{var t=lc.http.rest.formats[n].fromString(e.responseText);s.success(t)}catch(e){s.error(e)}})}}),lc.core.createClass("lc.layout.Handler",function(e){(e._lc_layout_handler=this)._listeners=[],this._refreshValues(e)},{_refreshValues:function(e){this._clientWidth=e.clientWidth,this._clientHeight=e.clientHeight,this._offsetWidth=e.offsetWidth,this._offsetHeight=e.offsetHeight,this._scrollWidth=e.scrollWidth,this._scrollHeight=e.scrollHeight},_check:function(e){e.clientWidth==this._clientWidth&&e.clientHeight==this._clientHeight&&e.offsetWidth==this._offsetWidth&&e.offsetHeight==this._offsetHeight&&e.scrollWidth==this._scrollWidth&&e.scrollHeight==this._scrollHeight||(lc.async.Callback.callListeners(this._listeners),this._refreshValues(e))}}),lc.layout.onChange=function(e,t){e._lc_layout_handler||new lc.layout.Handler(e),e._lc_layout_handler._listeners.push(t)},lc.layout.triggerChange=function(e){e._lc_layout_handler&&e._lc_layout_handler._check(e);for(var t=0;t<e.childNodes.length;++t)1==e.childNodes[t].nodeType&&lc.layout.triggerChange(e.childNodes[t])},window.addEventListener("resize",function(){lc.layout.triggerChange(document.body)}),lc.layout.getAbsolutePosition=function(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e.offsetParent!=document.body;)e=e.offsetParent,t.x-=e.scrollLeft,t.y-=e.scrollTop,t.x+=e.offsetLeft,t.y+=e.offsetTop;return t},lc.core.namespace("lc.locale",{_userLanguages:[],_lang:void 0,_namespaces:[],_listeners:[],_localized:[],setLanguage:function(e){if(-1!=(t=lc.locale._userLanguages.indexOf(e))){if(lc.locale._lang!=e){lc.locale._lang=e,window.localStorage?window.localStorage.setItem("lc.locale",e):lc.cookies.set("lc.locale",e,"/",31536e3),lc.log.debug("lc.locale","language set to: "+e);for(var t=0;t<lc.locale._namespaces.length;++t)lc.locale._namespaces[t].reload();lc.async.Callback.callListeners(lc.locale._listeners,[e]);for(t=0;t<lc.locale._localized.length;++t)this._updateLocalized(lc.locale._localized[t])}}else lc.log.debug("lc.locale","setLanguage ignored for unknown language: "+e)},getLanguage:function(){return lc.locale._lang},declare:function(e,t,n){Array.isArray(t)||(t=[t]);for(var s=0;s<t.length;++s)if(lc.locale.hasNamespace(t[s]))lc.log.warn("lc.locale","Locale namespace "+t[s]+" is already defined");else{var r=new lc.locale.Namespace(t[s],e,n);lc.locale._namespaces.push(r),lc.log.debug("lc.locale","Locale namespace "+r.name+" declared at "+e)}},loadDeclarations:function(s){var r=new lc.async.Future;return lc.http.rest.get(s).onerror(r).onsuccess(function(e){try{for(var t=0;t<e.namespaces.length;++t){var n=e.namespaces[t];"string"==typeof n?lc.locale.declare(s+"/",n,null):lc.locale.declare(s+"/",n.name,n.languages)}r.success()}catch(e){r.error(e)}}),r},hasNamespace:function(e){return null!=lc.locale.getNamespace(e)},getNamespace:function(e){for(var t=0;t<lc.locale._namespaces.length;++t)if(lc.locale._namespaces[t].name==e)return lc.locale._namespaces[t]},getFullyAvailableLanguages:function(){for(var e=null,t=new lc.async.JoinPoint,n=new lc.async.Future,s=0;s<lc.locale._namespaces.length;++s){var r=lc.locale._namespaces[s];if(Array.isArray(r.languages))if(null==e)e=r.languages.slice();else for(var o=0;o<e.length;++o)r.languages.indexOf(e[o])<0&&(e.splice(o,1),o--);else t.addToJoin(1),r.languages.onsuccess(new lc.async.Callback(r,function(){if(null==e)e=this.languages.slice();else for(;o<e.length;++o)this.languages.indexOf(e[o])<0&&(e.splice(o,1),o--);t.join()}))}return t.start(),t.onsuccess(function(){null===e&&(e=[]),n.success(e)}),n},getPreferredLanguageAmong:function(e){for(var t=0;t<lc.locale._userLanguages.length;++t)if(0<=e.indexOf(lc.locale._userLanguages[t]))return lc.locale._userLanguages[t];return null},listenLanguage:function(e){this._listeners.push(e),this._lang&&lc.async.Callback.callListeners(e,[this._lang])},unlistenLanguage:function(e){this._listeners.remove(e)},localizeAttribute:function(e,t,n,s,r){var o={namespace:n,key:s,params:r,element:e,attributeName:t,localize:function(e){this.element[t]=e}};this._localized.push(o),this._lang&&this._updateLocalized(o)},textNode:function(e,t,n){var s=document.createTextNode("");return lc.locale.localizeAttribute(s,"nodeValue",e,t,n),s},_updateLocalized:function(e){var t=lc.locale.getNamespace(e.namespace);t?t.getStringAsync(e.key,e.params).onsuccess(new lc.async.Callback(e,function(e){this.localize(e)})):e.localize("[unknown namespace '"+e.namespace+"']")}}),lc.core.createClass("lc.locale.Namespace",function(e,t,n){"/"!=t.charAt(t.length-1)&&(t+="/"),this.name=e,this.url=t+e,this._content=void 0,n?(this.languages=n,lc.locale._lang&&this.reload()):this.languages=lc.http.get(this.url+".languages").onsuccess(new lc.async.Callback(this,function(e){lc.log.debug("lc.locale","Languages loaded for namespace "+this.name);for(var t=e.split(","),n=[],s=0;s<t.length;++s){var r=t[s].trim();0<r.length&&n.push(r)}this.languages=n,lc.locale._lang&&this.reload()}))},{reload:function(){this._content=lc.http.get(this.url+"."+lc.locale._lang).onsuccess(new lc.async.Callback(this,function(e){this._content=this._parse(e),lc.log.debug("lc.locale","Namespace "+this.name+" loaded for language "+lc.locale._lang+": "+this._content.length+" localized strings")}))},getStringAsync:function(e,t){var n=new lc.async.Future;return Array.isArray(this.languages)?this._getStringAsync(n,e,t):this.languages.onsuccess(new lc.async.Callback(this,function(){this._getStringAsync(n,e,t)})),n},_getStringAsync:function(e,t,n){Array.isArray(this._content)?this._getStringAsync2(e,t,n):this._content.onsuccess(new lc.async.Callback(this,function(){this._getStringAsync2(e,t,n)}))},_getStringAsync2:function(e,t,n){e.success(this.getStringSync(t,n))},getStringSync:function(e,t){for(var n=e.toLowerCase(),s=0;s<this._content.length;++s)if(this._content[s].key==n)return this._resolve(e,this._content[s].value,t);return"[unknown locale key '"+e+"' in namespace '"+this.name+"']"},_resolve:function(e,t,n){return t},_parse:function(e){for(var t=e.split(/\n/g),n=[],s=0;s<t.length;++s){var r=t[s].trim();if(0!=r.length&&!r.startsWith("#")){var o=r.indexOf("=");o<0?lc.log.warn("lc.locale","Invalid locale line "+(s+1)+" in namespace "+this.name+": no '='"):n.push({key:r.substring(0,o).trim().toLowerCase(),value:r.substring(o+1).trim()})}}return n}}),function(){var e;window.localStorage&&((e=window.localStorage.getItem("lc.locale"))&&!lc.locale._userLanguages.contains(e)&&lc.locale._userLanguages.push(e));(e=lc.cookies.get("lc.locale"))&&!lc.locale._userLanguages.contains(e)&&lc.locale._userLanguages.push(e);for(var t=navigator.languages?navigator.languages:navigator.language?[navigator.language]:navigator.userLanguage?[navigator.userLanguage]:["en"],n=0;n<t.length;++n)lc.locale._userLanguages.contains(t[n])||lc.locale._userLanguages.push(t[n]);lc.locale._userLanguages.contains("en")||lc.locale._userLanguages.push("en")}(),lc.app.onLoaded(function(){lc.locale._lang||lc.locale.getFullyAvailableLanguages().onsuccess(function(e){var t=lc.locale.getPreferredLanguageAmong(e);t&&lc.locale.setLanguage(t)})}),lc.app.onDefined(["lc.html.processor","lc.locale"],function(){lc.html.processor.addPreProcessor(function(e,t,n){if(1==e.nodeType&&"LC-LOCALE"==e.nodeName){var s=e.getAttribute("namespace"),r=e.getAttribute("key"),o=lc.locale.textNode(s,r);return e.parentNode.insertBefore(document.createComment("lc-locale namespace="+s+" key="+r),e),e.parentNode.insertBefore(o,e),lc.html.remove(e),void t.stop()}},10)}),lc.core.namespace("lc.log",{Levels:{TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4},formatters:{_registry:{},register:function(e,t){lc.log.formatters._registry[e]=t},create:function(e,t){if(void 0===lc.log.formatters._registry[e])throw"Unknown log formatter: "+e;return new Function("argument","return new "+lc.log.formatters._registry[e]+"(argument)")(t)}},_formatComponents:[],_defaultLevel:2,_loggerLevel:{},setFormat:function(e){for(var t=[],n=0;n<e.length;){var s=e.indexOf("${",n);if(0<=s){var r=e.indexOf("}",s+2);if(0<r){n<s&&t.push(new lc.log.formatters.String(e.substring(n,s))),n=r+1;var o=e.substring(s+2,r),i=null;0<(s=o.indexOf(":"))&&(i=o.substring(s+1),o=o.substring(0,s)),t.push(lc.log.formatters.create(o,i));continue}}t.push(new lc.log.formatters.String(e.substring(n)));break}lc.log._formatComponents=t},setDefaultLevel:function(e){lc.log._defaultLevel=e},setLevel:function(e,t){"string"!=typeof e&&(e=lc.core.typeOf(e)),lc.log._loggerLevel[e]=t},log:function(e,t,n,s){if(s&&s.stack?n=n+"\r\n"+s.stack:n&&n.stack&&(n=n+"\r\n"+n.stack),e){if("string"!=typeof e&&(e=lc.core.typeOf(e)),void 0===lc.log._loggerLevel[e]){if(t<lc.log._defaultLevel)return!1}else if(t<lc.log._loggerLevel[e])return!1}else if(t<lc.log._defaultLevel)return!1;if(!n)return!0;for(var r="",o=0;o<lc.log._formatComponents.length;++o)r+=lc.log._formatComponents[o].format(e,t,n);t==lc.log.Levels.ERROR?console.error(r):t==lc.log.Levels.WARN?console.warn(r):t==lc.log.Levels.INFO?console.info(r):t==lc.log.Levels.DEBUG?console.debug(r):console.log(r)},trace:function(e,t,n){return lc.log.log(e,lc.log.Levels.TRACE,t,n)},debug:function(e,t,n){return lc.log.log(e,lc.log.Levels.DEBUG,t,n)},info:function(e,t,n){return lc.log.log(e,lc.log.Levels.INFO,t,n)},warn:function(e,t,n){return lc.log.log(e,lc.log.Levels.WARN,t,n)},error:function(e,t,n){return lc.log.log(e,lc.log.Levels.ERROR,t,n)},fitStringSize:function(e,t){if(0<t){if(e.length>t){var n=Math.floor((t-3)/2);e=e.substring(0,n)+"..."+e.substring(e.length-(t-3-n))}for(;e.length<t;)e+=" "}return e}}),lc.core.createClass("lc.log.formatters.Formatter",function(){},{format:function(e,t,n){throw"Method lc.log.formatters.Formatter.format(logger, level, message) must be implemented on "+lc.core.typeOf(this)}}),lc.core.extendClass("lc.log.formatters.String",lc.log.formatters.Formatter,function(e){this.string=e},{format:function(e,t,n){return this.string}}),lc.core.extendClass("lc.log.formatters.Time",lc.log.formatters.Formatter,function(){},{format:function(e,t,n){var s=new Date;return(""+s.getFullYear()).padStart(4,"0")+"-"+(""+(s.getMonth()+1)).padStart(2,"0")+"-"+(""+s.getDate()).padStart(2,"0")+" "+(""+s.getHours()).padStart(2,"0")+":"+(""+s.getMinutes()).padStart(2,"0")+":"+(""+s.getSeconds()).padStart(2,"0")+"."+(""+s.getMilliseconds()).padStart(3,"0")}}),lc.log.formatters.register("time","lc.log.formatters.Time"),lc.core.extendClass("lc.log.formatters.DateTime",lc.log.formatters.Formatter,function(){},{format:function(e,t,n){return(new Date).toLocaleString()}}),lc.log.formatters.register("datetime","lc.log.formatters.DateTime"),lc.core.extendClass("lc.log.formatters.Level",lc.log.formatters.Formatter,function(e){e=parseInt(e),this.size=e<=0?5:e},{format:function(e,t,n){var s="";for(var r in lc.log.Levels)if(lc.log.Levels[r]==t){s=r;break}return lc.log.fitStringSize(s,this.size)}}),lc.log.formatters.register("level","lc.log.formatters.Level"),lc.core.extendClass("lc.log.formatters.Logger",lc.log.formatters.Formatter,function(e){e=parseInt(e),this.size=e},{format:function(e,t,n){return lc.log.fitStringSize(e,this.size)}}),lc.log.formatters.register("logger","lc.log.formatters.Logger"),lc.core.extendClass("lc.log.formatters.Message",lc.log.formatters.Formatter,function(e){e=parseInt(e),this.size=e},{format:function(e,t,n){return lc.log.fitStringSize(""+n,this.size)}}),lc.log.formatters.register("message","lc.log.formatters.Message"),lc.log.setFormat("${time} ${level} ${logger:20} ${message}"),lc.app.onDefined(["lc.resources","lc.Cache"],function(){lc.resources._css_cache=new lc.Cache,lc.resources.css=function(e){var t=e instanceof lc.URL?e:new lc.URL(e),n=t.toString(),s=lc.resources._css_cache.get(n);if(s)return s.future;var r=document.createElement("LINK");return r.rel="stylesheet",r.type="text/css",s={url:t,element:r,future:new lc.async.Future},lc.resources._css_cache.set(n,s),lc.app.pending(s.future),r.onload=function(){lc.log.debug("lc.resources","CSS loaded: "+n),s.future.success(r)},r.onerror=function(){lc.log.error("lc.resources","Error loading CSS "+n),js.future.error("CSS loading error")},r.href=n,document.getElementsByTagName("HEAD")[0].appendChild(r),s.future}}),lc.app.onDefined(["lc.resources","lc.Cache"],function(){lc.resources._html_cache=new lc.Cache(9e5),lc.resources.html=function(e){var t=e instanceof lc.URL?e:new lc.URL(e),n=t.toString(),s=lc.resources._html_cache.get(n);return s||(s={url:t,html:null,future:new lc.async.Future},lc.resources._html_cache.set(n,s),lc.http.get(n).onsuccess(function(e){s.html=e,s.future.success(e)}).onerror(function(e){s.html="<div>"+e+"</div>",s.future.success(s.html)})),s.future},lc.resources.htm=lc.resources.html}),lc.app.onDefined(["lc.resources","lc.Cache"],function(){lc.resources._js_cache=new lc.Cache,lc.resources.js=function(e){var t=e instanceof lc.URL?e:new lc.URL(e),n=t.toString(),s=lc.resources._js_cache.get(n);if(s)return s.future;var r=document.createElement("SCRIPT");return s={url:t,element:r,future:new lc.async.Future},lc.resources._js_cache.set(n,s),lc.app.pending(s.future),r.type="text/javascript",r.onload=function(){lc.log.debug("lc.resources","Javascript loaded: "+n),lc.app.newDefinitionsAvailable(),s.future.success(r)},r.onerror=function(){lc.log.error("lc.resources","Error loading javascript "+n),s.future.error("Javascript loading error")},r.src=n,document.getElementsByTagName("HEAD")[0].appendChild(r),s.future},lc.resources.javascript=lc.resources.js}),lc.core.namespace("lc.resources",{load:function(e,t){var n=e instanceof lc.URL?e:new lc.URL(e);if(!t){var s=n.path.lastIndexOf(".");if(s<0){lc.log.error("lc.resources","Unable to load a resource without an extension: "+n.toString());var r=new lc.async.Future;return r.error("Unable to load a resource without an extension: "+n.toString()),r}t=n.path.substring(s+1)}return void 0===lc.resources[t]&&(t="unknownType"),lc.resources[t](n)},loadInSequence:function(t,n){var s=new lc.async.Future,r=function(e){e!=t.length?lc.resources.load(t[e],n).onsuccess(new lc.async.Callback(this,r,[e+1])).onerror(s):s.success(null)};return r(0),s},loadInParallel:function(e,t){for(var n=new lc.async.JoinPoint,s=0;s<e.length;++s)n.addToJoin(lc.resources.load(e[s],t));return n.start(),n},_default_cache:null,unknownType:function(e){lc.resources._default_cache||(lc.resources._default_cache=new lc.Cache(6e5));var t=e instanceof lc.URL?e.toString():e,n=lc.resources._default_cache.get(t);if(n)return n.future;var s=lc.http.get(e);return n={future:s},lc.resources._default_cache.set(t,n),s}}),lc.core.createClass("lc.URL",function(e,t){if(e instanceof lc.URL||void 0!==e.protocol)return this.protocol=e.protocol,this.host=e.host,this.port=e.port,this.path=e.path,this.hash=e.hash,void(this.params=lc.core.copy(e.params));"function"==typeof e.toString&&(e=e.toString());var n=e.indexOf("://");if(0<n)this.protocol=e.substr(0,n).toLowerCase(),n=(e=e.substr(n+3)).indexOf("/"),this.host=e.substr(0,n),e=e.substr(n),0<(n=this.host.indexOf(":"))?(this.port=this.host.substr(n+1),this.host=this.host.substr(0,n)):this.port=null;else if(window&&!t?(this.protocol=window.location.protocol.substr(0,window.location.protocol.length-1),this.host=window.location.hostname,this.port=window.location.port):(this.protocol="",this.host="",this.port=""),!e.startsWith("/")&&!t){var s;if(document.baseURI)s=new lc.URL(document.baseURI);else{var r=document.getElementsByTagName("base");s=0<r.length?new lc.URL(r[0].href):new lc.URL(location.toString())}(n=(s=s.path).lastIndexOf("/"))<s.length-1&&(s=s.substring(0,n+1)),e=s+e}if(0<(n=e.indexOf("#"))&&(this.hash=e.substr(n+1),e=e.substr(0,n)),n=e.indexOf("?"),this.params=new Object,0<n){for(this.path=e.substr(0,n),e=e.substr(n+1);0<e.length&&0<=(n=e.indexOf("&"));){var o=e.substr(0,n);e=e.substr(n+1),0<(n=o.indexOf("="))?this.params[lc.URL.decode(o.substr(0,n))]=lc.URL.decode(o.substr(n+1)):this.params[lc.URL.decode(o)]=""}0<e.length&&(0<(n=e.indexOf("="))?this.params[lc.URL.decode(e.substr(0,n))]=lc.URL.decode(e.substr(n+1)):this.params[lc.URL.decode(e)]="")}else this.path=e;if(!t)for("/"!=this.path.substr(0,1)&&window.location.pathname&&(n=(e=window.location.pathname).lastIndexOf("/"),e=e.substr(0,n+1),this.path=e+this.path);0<(n=this.path.indexOf("/../"));){var i=this.path.substr(0,n).lastIndexOf("/");if(i<0)break;this.path=this.path.substr(0,i+1)+this.path.substr(n+4)}this.host=this.host.toLowerCase(),this.path=this.path.toLowerCase()},{protocol:null,host:null,port:null,path:null,hash:null,params:null,toString:function(){var e;this.protocol?(e=this.protocol+"://"+this.host,this.port&&(e+=":"+this.port)):e="",e+=this.path;var t=!0;for(var n in this.params)t?(e+="?",t=!1):e+="&",e+=encodeURIComponent(n)+"="+encodeURIComponent(this.params[n]);return this.hash&&(e+="#"+this.hash),e},equals:function(e){if(!this.equalsWithoutParameters(e))return!1;for(var t in this.params)if(e.params[t]!=this.params[t])return!1;for(var t in e.params)if(e.params[t]!=this.params[t])return!1;return!0},equalsWithoutParameters:function(e){return this.protocol==e.protocol&&(this.host==e.host&&(this.port==e.port&&this.path==e.path))},isRelative:function(){return!this.path.startsWith("/")},applyRelative:function(e){var t=new lc.URL(this);if(!t.path.endsWith("/")){var n=t.path.lastIndexOf("/");t.path=t.path.substring(0,n+1)}for(t.path+=e.path,t.params=lc.core.copy(e.params),t.hash=e.hash;0<(n=t.path.indexOf("/../"));){var s=t.path.substr(0,n).lastIndexOf("/");if(s<0)break;t.path=t.path.substr(0,s+1)+t.path.substr(n+4)}return t}}),lc.URL.decode=function(e){return decodeURIComponent(e).replace(/\+/g," ")},lc.core.namespace("lc.xml",{getChildElementsByName:function(e,t){t=t.toUpperCase();for(var n=[],s=0;s<e.childNodes.length;++s)1==e.childNodes[s].nodeType&&e.childNodes[s].nodeName==t&&n.push(e.childNodes[s]);return n},getChildByName:function(e,t){t=t.toUpperCase();for(var n=0;n<e.childNodes.length;++n)if(1==e.childNodes[n].nodeType&&e.childNodes[n].nodeName==t)return e.childNodes[n];return null},isAncestorOf:function(e,t){if(e===t)return!1;for(;t.parentNode&&t.parentNode!=t;){if(e===t.parentNode)return!0;t=t.parentNode}return!1}}),lc.app.onLoaded(function(){lc.log.trace("lc.html.processor","Processing body at application startup"),lc.html.processor.process(document.body,function(){lc.layout.triggerChange(document.body)})}),lc.core._loaded=!0,lc.app.newDefinitionsAvailable();
//# sourceMappingURL=lc-core.min.js.map